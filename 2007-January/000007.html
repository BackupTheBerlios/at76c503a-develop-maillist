<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [at76c503a-develop] at76c503: sometimes the device reset doesn't	work
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/at76c503a-develop/2007-January/index.html" >
   <LINK REL="made" HREF="mailto:at76c503a-develop%40lists.berlios.de?Subject=Re%3A%20%5Bat76c503a-develop%5D%20at76c503%3A%20sometimes%20the%20device%20reset%20doesn%27t%0A%09work&In-Reply-To=%3C20070110202616.GA10807%40bogon.ms20.nix%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000008.html">
   
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[at76c503a-develop] at76c503: sometimes the device reset doesn't	work</H1>
    <B>Guido Guenther</B> 
    <A HREF="mailto:at76c503a-develop%40lists.berlios.de?Subject=Re%3A%20%5Bat76c503a-develop%5D%20at76c503%3A%20sometimes%20the%20device%20reset%20doesn%27t%0A%09work&In-Reply-To=%3C20070110202616.GA10807%40bogon.ms20.nix%3E"
       TITLE="[at76c503a-develop] at76c503: sometimes the device reset doesn't	work">agx at sigxcpu.org
       </A><BR>
    <I>Wed Jan 10 21:26:16 CET 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="000008.html">[at76c503a-develop] Adding the at76_usb wireless driver
</A></li>
        
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7">[ date ]</a>
              <a href="thread.html#7">[ thread ]</a>
              <a href="subject.html#7">[ subject ]</a>
              <a href="author.html#7">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,
when pluggin in my at76c503 the adapter sometimes (maybe 1 out of 10
cases) doesn't get detected properly. This is what happens:

/var/scratch/at76c503a/git/at76c503.c: opmode -32
                                       ^^^^^^^^^^
Is this broken pipe in do_probe o.k.? I'm always seeing this.

/var/scratch/at76c503a/git/at76c503.c: need to download firmware
/var/scratch/at76c503a/git/at76c503.c: firmware board 3 version 1.101.0#84 (int 57a4:64, ext 3c44:5808)
/var/scratch/at76c503a/git/at76c503.c: firmware id 1.101.0-84 503 RFMD Copyright (c) 1999-2000 by Atmel Corporation
/var/scratch/at76c503a/git/at76c503.c: downloading internal firmware
drivers/usb/core/inode.c: creating file '010'
hub 2-0:1.0: state 7 ports 2 chg 0000 evt 0002
/var/scratch/at76c503a/git/at76c503.c: downloading internal firmware
/var/scratch/at76c503a/git/at76c503.c: sending REMAP
/var/scratch/at76c503a/git/at76c503.c: sleeping for 2 seconds
/var/scratch/at76c503a/git/at76c503.c: resetting the device
ohci_hcd 0001:10:19.0: GetStatus roothub.portstatus [0] = 0x00100103 PRSC PPS PES CCS
usb 2-1: reset full speed USB device using ohci_hcd and address 10
ohci_hcd 0001:10:19.0: GetStatus roothub.portstatus [0] = 0x00100103 PRSC PPS PES CCS
hub 2-0:1.0: state 7 ports 2 chg 0000 evt 0002
usb 2-1: ep0 maxpacket = 8
usb 2-1: manual set_interface for iface 0, alt 0
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
This is the actual problem: the reset doesn't get detected properly.  In
case it works the last line looks different:

usb 2-1: config index 0 changed (#1)
usb 2-1: device firmware changed
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
When seeing this everything works fine (device gets disconnected,
redetected and the external firmware gets downloaded):

hub 2-0:1.0: logical disconnect on port 1
hub 2-0:1.0: state 7 ports 2 chg 0002 evt 0002
hub 2-0:1.0: port 1, status 0101, change 0000, 12 Mb/s
usb 2-1: USB disconnect, address 6
usb 2-1: unregistering device
usb 2-1: usb_disable_device nuking all URBs
usb 2-1: unregistering interface 2-1:1.0
/var/scratch/at76c503a/git/at76c503.c: wlan0 disconnecting
/var/scratch/at76c503a/git/at76c503.c: at76_usb disconnected

I tried increasing the firmware download timeout but this doesn't seem
to help. Any ideas (arch is ppc)?
Cheers,
 -- Guido

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000008.html">[at76c503a-develop] Adding the at76_usb wireless driver
</A></li>
	
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7">[ date ]</a>
              <a href="thread.html#7">[ thread ]</a>
              <a href="subject.html#7">[ subject ]</a>
              <a href="author.html#7">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/at76c503a-develop">More information about the at76c503a-develop
mailing list</a><br>
</body></html>
